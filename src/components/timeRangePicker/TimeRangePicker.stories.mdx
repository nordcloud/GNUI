import { Meta, Story, Canvas } from "@storybook/addon-docs";
import { previousMonday, addDays } from "date-fns";
import { Spacer } from "../spacer";
import { TimeRangePicker } from ".";

<Meta title="Forms/TimeRangePicker" component={TimeRangePicker} />

# TimeRangePicker

> The `TimeRangePicker` component accepts a `onChange` function and an optional `initTimeRange` in type of `Interval`, to privode the function of selecting a time range or date(s). Histogram is supported in "Hours" type.

## TimeRangePicker properties

|    properties | required | type                                          | description                                                                                               |
| ------------: | :------: | :-------------------------------------------- | :-------------------------------------------------------------------------------------------------------- |
| initTimeRange |  false   | Interval                                      | Start date and end date should be within the same day, current date will be used otherwise and by default |
|          type |  false   | <code>Days</code>, <code>Hours</code>         | Type of time selected in component                                                                        |
|    weekCounts |  false   | DailyCount[]                                  | Item counts in each time range (Type "Hours" only)                                                        |
| countsLoading |  false   | boolean                                       | Loading state of week counts (Type "Hours" only)                                                          |
|  disabledDays |  false   | Matcher[]                                     | Dates not allowed to select                                                                               |
|      onChange |   true   | <code>(newTimeRange: Interval) => void</code> | Function to handle timeRange change                                                                       |
|  onWeekChange |  false   | <code>(monday: Date) => void</code>           | Function to submit when showing week updates (Type "Hours" only)                                          |

```typescript
import { Interval } from "date-fns";
import { Matcher } from "react-day-picker";

type Interval = {
  start: Date | number;
  end: Date | number;
};

type DailyCount = {
  date: Date;
  counts: [number, number, number, number];
};

type Matcher = (boolean | (date: Date)) => boolean | Date | Date[] | DateRange | DateBefore | DateAfter | DateInterval | DayOfWeek
// A value or a function that matches a specific day
```

### Type "Days"

<Canvas>
  <Story name="timerangepicker of days">
    {() => {
      const initValue = {
        start: new Date(),
        end: new Date(),
      };
      const [value, setValue] = React.useState(initValue);
      return (
        <>
          <TimeRangePicker
            type="Days"
            initTimeRange={initValue}
            onChange={setValue}
          />
          <Spacer height="20rem" />
          <div id="result-days">Current Value: {JSON.stringify(value)}</div>
        </>
      );
    }}
  </Story>
</Canvas>

## Type "Hours"

<Canvas>
  <Story name="timerangepicker of hours ">
    {() => {
      const [value, setValue] = React.useState();
      return (
        <>
          <TimeRangePicker onChange={setValue} />
          <Spacer height="20rem" />
          <div id="result-hours">Current Value: {JSON.stringify(value)}</div>
        </>
      );
    }}
  </Story>
</Canvas>

## Type "Hours" with Histogram

<Canvas>
  <Story name="timerangepicker of hours with histogram">
    {() => {
      const [value, setValue] = React.useState();
      const monday = previousMonday(new Date());
      return (
        <>
          <TimeRangePicker
            weekCounts={[
              { date: monday, counts: [1, 2, 3, 4] },
              { date: addDays(monday, 1), counts: [0, 2, 3, 4] },
              { date: addDays(monday, 2), counts: [1, 0, 3, 4] },
              { date: addDays(monday, 3), counts: [1, 2, 0, 4] },
              { date: addDays(monday, 4), counts: [1, 2, 3, 0] },
              { date: addDays(monday, 5), counts: [0, 0, 0, 0] },
              { date: addDays(monday, 6), counts: [0, 0, 0, 0] },
            ]}
            onChange={setValue}
          />
          <Spacer height="20rem" />
          <div id="result-hours-with-histogram">
            Current Value: {JSON.stringify(value)}
          </div>
        </>
      );
    }}
  </Story>
</Canvas>
